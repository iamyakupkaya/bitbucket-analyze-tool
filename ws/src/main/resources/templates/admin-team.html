<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en" class="light-style layout-menu-fixed " translate="no" dir="ltr"
      data-theme="theme-default" data-assets-path="static/" data-template="vertical-menu-template-free">

<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
  <title>Administrator Team Members</title>
  <meta name="description"
        content="Most Powerful &amp; Comprehensive Bootstrap 5 HTML Admin Dashboard Template built for developers!" />
  <meta name="keywords" content="dashboard, bootstrap 5 dashboard, bootstrap 5 design, bootstrap 5">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link
          href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&amp;display=swap"
          rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <!-- Icons. Uncomment required icon fonts -->
  <link rel="stylesheet" th:href="@{/vendor/fonts/boxicons.css}" />
  <!-- Core CSS -->
  <link rel="stylesheet" th:href="@{/vendor/css/core.css}" class="template-customizer-core-css" />
  <link rel="stylesheet" th:href="@{/vendor/css/theme-default.css}" class="template-customizer-theme-css" />
  <link rel="stylesheet" th:href="@{/css/demo.css}" />
  <!-- Vendors CSS -->
  <link rel="stylesheet" th:href="@{/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" />
  <!-- Helpers -->
  <script th:src="@{/vendor/js/helpers.js}"></script>
  <script th:src="@{/js/config.js}"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="async" src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'GA_MEASUREMENT_ID');
  </script>
  <!-- Custom notification for demo -->
  <!-- beautify ignore:end -->
</head>

<body>

<!-- Layout wrapper -->
<div class="layout-wrapper layout-content-navbar  ">
  <div class="layout-container">

    <!-- Menu -->

    <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">


      <div class="app-brand demo ">
        <a th:href="@{/}" class="app-brand-link">
          <h5 class="card-title text-primary">Bitbucket Analyse Tool</h5>
        </a>

        <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
          <i class="bx bx-chevron-left bx-sm align-middle"></i>
        </a>
      </div>
      <div class="menu-inner-shadow"></div>

      <ul class="menu-inner py-1">
        <!-- ------------------------------------- -->
        <!-- Home  -->
        <li class="menu-item active">
          <a th:href="@{/}" class="menu-link">
            <i class="menu-icon tf-icons bx bx-home-circle"></i>
            <div data-i18n="Analytics">Home</div>
          </a>
        </li>
        <!-- ------------------------------------- -->
        <!-- Pull request -->
        <li class="menu-item">
          <a href="javascript:void(0);" class="menu-link menu-toggle">
            <i class="menu-icon tf-icons bx bx-git-pull-request"></i>
            <div data-i18n="Layouts">Pull Request</div>
          </a>
          <ul class="menu-sub">
            <li class="menu-item active">
              <a th:href="@{/pull-requests}" class="menu-link">
                <i class="menu-icon tf-icons bx bx-table"></i>
                <div data-i18n="Tables">Author List</div>
              </a>
            </li>
          </ul>
        </li>
        <!-- ------------------------------------- -->
        <!-- Statistics Reviewer -->
        <li class="menu-item">
          <a href="javascript:void(0)" class="menu-link menu-toggle">
            <i class="menu-icon tf-icons bx bx-comment-detail"></i>
            <div data-i18n="User interface">Review</div>
          </a>
          <ul class="menu-sub">
            <li class="menu-item active">
              <a th:href="@{/reviewer}" class="menu-link">
                <i class="menu-icon tf-icons bx bx-table"></i>
                <div data-i18n="Tables">Reviewer List</div>
              </a>
            </li>
          </ul>
        </li>
        <!-- ------------------------------------- -->
        <!--Teams-->
        <li class="menu-item">
          <a href="javascript:void(0);" class="menu-link menu-toggle">
            <i class="menu-icon tf-icons bx bx-group"></i>
            <div data-i18n="Layouts">Teams and Users</div>
          </a>
          <ul class="menu-sub">
            <li class="menu-item">
              <a th:href="@{/users}" class="menu-link">
                <i class="menu-icon tf-icons bx bxs-user-detail"></i>
                <div data-i18n="Tables">Users</div>
              </a>
            </li>
          </ul>
          <ul class="menu-sub">
            <li class="menu-item" id="createTeam">
              <a href="javascript:void(0);" class="menu-link menu-toggle">
                <i class="menu-icon tf-icons bx bx-group"></i>
                <div data-i18n="Layouts">Teams</div>
              </a>
            </li>
          </ul>
        </li>
        <!-- ------------------------------------- -->
        <!--Administrator-->
        <li class="menu-item">
          <a th:href="@{/logout}" class="menu-link">
            <i class="menu-icon tf-icons bx bx-user"></i>
            <div data-i18n="Analytics">Administrator - Logout</div>
          </a>
        </li>
        <!-- Misc -->
      </ul>
      <!-- / Menu -->
    </aside>
    <!-- Layout container -->
    <div class="layout-page">
      <!-- Navbar -->
      <div class="content">
        <div class="container-xxl flex-grow-1 container-p-y">
          <div class="card">

            <h4 class="card-header fw-bold py-3 mb-4">
              Team Code /  <span class="text-muted fw-light" th:text="${headerTeamCode}"></span>
            </h4>
            <div class="card-body">
              <ul class="d-flex p-0 m-0">
                <li class="d-inline-flex mb-4 pb-1">
                  <div class="avatar flex-shrink-0 me-3">
                                        <span class="avatar-initial rounded bg-label-info"><i
                                                class='bx bx-stats'></i></span>
                  </div>
                  <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                    <div class="me-2">
                      <small class="text-muted d-block mb-1">Manager</small>
                      <h6 class="mb-0" th:text="${manager}">Manager Name</h6>
                    </div>
                  </div>
                  <div class="avatar flex-shrink-0 me-3">
                                       <span class="avatar-initial rounded bg-label-info"><i
                                               class='bx bx-stats'></i></span>
                  </div>
                  <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                    <div class="me-2">
                      <small class="text-muted d-block mb-1">Total Pull Request</small>
                      <h6 class="mb-0" th:text="${totalTeamPR}"></h6>
                    </div>
                  </div>
                  <div class="avatar flex-shrink-0 me-3">
                                       <span class="avatar-initial rounded bg-label-info"><i
                                               class='bx bx-stats'></i></span>
                  </div>
                  <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                    <div class="me-2">
                      <small class="text-muted d-block mb-1">Total Reviewer</small>
                      <h6 class="mb-0" th:text="${totalReviewer}"></h6>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <nav class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
           id="layout-navbar">
        <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0   d-xl-none ">
          <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
            <i class="bx bx-menu bx-sm"></i>
          </a>
        </div>

        <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
          <!-- Search -->
          <div class="navbar-nav align-items-center">
            <div class="nav-item d-flex align-items-center">
              <i class="bx bx-search fs-4 lh-0"></i>
              <input type="text" class="form-control border-0 shadow-none" placeholder="Search..."
                     aria-label="Search..." id="searchInput" onkeyup="searchFunction('membersTable')">
            </div>
          </div>
          <!-- /Search -->
        </div>
      </nav>
      <!-- / Navbar -->
      <!-- Content wrapper -->
      <div class="content-wrapper">
        <!-- Content -->
        <div class="container-xxl flex-grow-1 container-p-y">
          <div class="col-xl-12">
            <div class="nav-align-top mb-4">
              <ul class="nav nav-pills mb-3 nav-fill" role="tablist">
                <li class="nav-item">
                  <button type="button" class="nav-link active" role="tab" data-bs-toggle="tab"
                          data-bs-target="#navs-pills-justified-home"
                          aria-controls="navs-pills-justified-home" aria-selected="true"><i
                          class="tf-icons bx bx-group"></i> Team Members </button>
                </li>
                <li class="nav-item">
                  <button type="button" class="nav-link" role="tab" data-bs-toggle="tab"
                          data-bs-target="#navs-pills-justified-profile"
                          aria-controls="navs-pills-justified-profile" aria-selected="false"><i
                          class="tf-icons bx bx-window-open"></i> Pull Request Analyze</button>
                </li>
                <li class="nav-item">
                  <button type="button" class="nav-link" role="tab" data-bs-toggle="tab"
                          data-bs-target="#navs-pills-justified-messages"
                          aria-controls="navs-pills-justified-messages" aria-selected="false"><i
                          class="tf-icons bx bx-window-open"></i> Reviewer Statistics</button>
                </li>
              </ul>
              <div class="tab-content">
                <div class="tab-pane fade show active" id="navs-pills-justified-home" role="tabpanel">
                  <div class="card">
                    <h5 class="card-header">All Users</h5>
                    <div class="table-responsive text-nowrap">
                      <table class="table table-hover" id="membersTable">
                        <thead>
                        <tr>
                          <th>User Name</th>
                          <th>First Name</th>
                          <th>Last Name</th>
                          <th>Role</th>
                          <th> </th>
                        </tr>
                        </thead>
                        <tbody class="table-border-bottom-0">
                        <tr th:each="user: ${users}">
                          <td>
                            <ul class="list-unstyled users-list m-0 avatar-group d-flex align-items-center">
                              <a th:href="@{'/users/'+${user.username}}">
                                <strong th:text="${user.username}"></strong></a>
                            </ul>
                          </td>
                          <td>
                            <strong th:text="${user.firstname}"></strong>
                          </td>
                          <td>
                            <strong th:text="${user.lastname}"></strong>
                          </td>
                          <form th:action="@{'setRole'}">
                          <td>
                            <select class="form-control d-inline-flex" required name="role">
                              <option value="" disabled selected th:text="${user.role}"></option>
                              <option th:each="role : ${roles}"  th:value="${role}" th:text="${role}"></option>
                            </select>
                          </td>
                          <td>
                            <input type="hidden"  name="username" th:value="${user.username}">
                            <button style="margin:3px;"  type="submit" class="btn btn-outline-success">Assign</button>
                            </form>
                          </td>
                        </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <div class="tab-pane fade" id="navs-pills-justified-profile" role="tabpanel">
                  <div class="card">
                    <h5 class="card-header">Pull Request Analyze</h5>
                    <div class="table-responsive text-nowrap">
                      <table class="table table-hover" id="authorTable">
                        <thead>
                        <tr>
                          <th>Members</th>
                          <th>Total</th>
                          <th>Merged</th>
                          <th>Open</th>
                          <th>Declined</th>
                        </tr>
                        </thead>
                        <tbody class="table-border-bottom-0">
                        <tr th:each="teamUsersStatistic : ${teamUsersStatistics}">
                          <td>
                            <ul class="list-unstyled users-list m-0 avatar-group d-flex align-items-center">
                              <a th:href="@{'/pull-requests/author/'+${teamUsersStatistic.name}}"><strong
                                      th:text="${teamUsersStatistic.name}"></strong></a>
                            </ul>
                          </td>
                          <td>
                            <strong th:text="${teamUsersStatistic.totalPRs}"></strong>
                          </td>
                          <td>
                            <strong th:text="${teamUsersStatistic.totalMergedPRs}"></strong>
                          </td>
                          <td>
                            <strong th:text="${teamUsersStatistic.totalOpenPRs}"></strong>
                          </td>
                          <td>
                            <strong th:text="${teamUsersStatistic.totalDeclinedPRs}"></strong>
                          </td>
                        </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <div class="tab-pane fade " id="navs-pills-justified-messages" role="tabpanel">
                  <div class="card">
                    <h5 class="card-header">Reviewer Statistics</h5>
                    <div class="table-responsive text-nowrap">
                      <table class="table table-hover" id="reviewerTable">
                        <thead>
                        <tr>
                          <th>Members</th>
                          <th>Total</th>
                          <th>Approve</th>
                          <th>No Action</th>
                        </tr>
                        </thead>
                        <tbody class="table-border-bottom-0">
                        <tr th:each="teamReviewerStatistic : ${teamReviewerStatistics}">
                          <td>
                            <ul class="list-unstyled users-list m-0 avatar-group d-flex align-items-center">
                              <a th:href="@{'/reviewer/'+${teamReviewerStatistic.name}}" target="_blank"><strong
                                      th:text="${teamReviewerStatistic.name}"></strong></a>
                            </ul>
                          </td>
                          <td>
                            <strong th:text="${teamReviewerStatistic.totalReview}"></strong>
                          </td>
                          <td>
                            <strong th:text="${teamReviewerStatistic.totalApprove}"></strong>
                          </td>
                          <td>
                            <strong th:text="${teamReviewerStatistic.totalUnApprove}" ></strong>
                          </td>
                        </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- / Content -->

          <!-- Footer -->
          <footer class="content-footer footer bg-footer-theme">
            <div class="container-xxl d-flex flex-wrap justify-content-between py-2 flex-md-row flex-column">
            </div>
          </footer>
          <!-- / Footer -->


          <div class="content-backdrop fade"></div>
        </div>
        <!-- Content wrapper -->
      </div>
      <!-- / Layout page -->
    </div>



    <!-- Overlay -->
    <div class="layout-overlay layout-menu-toggle"></div>
  </div>
</div>
<!-- / Layout wrapper -->

<!-- Core JS -->
<!-- build:js static/vendor/js/core.js -->
<script th:src="@{/vendor/libs/jquery/jquery.js}"></script>
<script th:src="@{/vendor/libs/popper/popper.js}"></script>
<script th:src="@{/vendor/js/bootstrap.js}"></script>
<script th:src="@{/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>

<script th:src="@{/vendor/js/menu.js}"></script>
<!-- endbuild -->

<!-- Vendors JS -->



<!-- Main JS -->
<script th:src="@{/js/main.js}"></script>

<!-- Page JS -->


<!-- Search JS -->
<script th:src="@{/js/searchBar.js}"></script>

<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="../../../buttons.github.io/buttons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
<script type="text/javascript" th:inline="javascript">
  /*<![CDATA[*/

  var teamList = /*[[${htmlTeamList}]]*/;

  var baseLi =  document.getElementById("createTeam");
  var ul = document.createElement('ul');
  ul.setAttribute('class', 'menu-sub');

  for(i=0;i<teamList.length;i++){
    const text = document.createTextNode(teamList[i]);

    var a =  document.createElement('a');
    a.setAttribute('href', '/team/'+teamList[i]);
    a.setAttribute('class', 'menu-link');

    a.appendChild(text);

    var li = document.createElement('li');
    li.setAttribute('class', 'menu-item active');

    li.appendChild(a);
    ul.appendChild(li);
  }
baseLi.appendChild(ul);

/*]]>*/
      </script>
</body>
</html>